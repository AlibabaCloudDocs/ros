# 创建资源栈

本文为您介绍如何通过资源编排服务ROS（Resource Orchestration Service）创建资源栈。

创建资源栈有以下两种方式：

-   标准：创建新资源。

    当您使用模板创建资源栈时，默认创建新资源。具体操作，请参见[通过模板创建资源栈](/intl.zh-CN/模板/管理模板/我的模板/通过模板创建资源栈.md)和[通过示例模板创建资源栈](/intl.zh-CN/快速入门/通过示例模板创建资源栈.md)。

-   资源导入：使用现有资源。

    您可以将现有资源通过资源导入的方式，导入到ROS的资源栈中，统一进行资源管理和编排。具体操作，请参见[使用现有资源创建资源栈](/intl.zh-CN/资源导入/使用现有资源创建资源栈.md)。


## 使用新资源创建资源栈

**操作步骤**

1.  登录[资源编排控制台](http://ros.console.aliyun.com)。

2.  在左侧导航栏，单击**资源栈**。

3.  在页面左上角的地域下拉列表，选择资源栈的所在地域。

4.  在资源栈列表页面，单击**创建资源栈**，然后在下拉列表中选择**使用新资源（标准）**。

5.  在选择模板页面，根据需要选择模板，单击**下一步**。

    您可以选择JSON、YAML或Terraform三种类型的模板。关于模板的更多信息，请参见[模板结构说明](/intl.zh-CN/模板/模板语法/模板结构说明.md)。

6.  在配置模板参数页面，配置**资源栈名称**和**参数录入**，单击**下一步**。

7.  在配置资源栈页面，配置以下参数，单击**下一步**。

    |配置项|说明|
    |---|--|
    |**资源栈策略**|    -   **无资源栈策略**：不设置资源栈策略。
    -   **输入资源栈策略**：上传文件或在文本框手动输入资源栈策略。
关于资源栈策略的更多信息，请参见[资源栈策略](/intl.zh-CN/资源栈/资源栈策略.md)。 |
    |**失败时回滚**|    -   **已启用**：创建资源栈失败时，启用回滚策略。
    -   **已禁用**：创建资源栈失败时，禁用回滚策略。 |
    |**超时设置**|如果所有资源的创建或更新没有在该时间内完成，系统将自动回滚到创建或更新之前的状态。|
    |**删除保护**|防止资源栈被意外删除。    -   **已启用**：启用删除保护。
    -   **已禁用**：禁用删除保护。 |
    |**RAM角色**|您可以创建可信实体为资源编排服务的RAM角色，然后根据ROS模板中资源所需最小权限为RAM角色授权。    -   如果指定RAM角色，ROS将根据RAM角色的权限创建资源栈。关于如何创建RAM角色和为RAM角色授权，请参见[创建可信实体为阿里云服务的RAM角色](/intl.zh-CN/角色管理/创建RAM角色/创建可信实体为阿里云服务的RAM角色.md)、[为RAM角色授权](/intl.zh-CN/角色管理/为RAM角色授权.md)。
    -   如果不指定RAM角色，ROS将使用当前账号相关权限创建资源栈。 |
    |**标签**|由一对键值对组成，方便您对资源栈进行分类。|

8.  在检查并确认页面，单击**创建**。

    资源栈创建成功后，**状态**列显示**创建成功**。


## 使用现有资源创建资源栈

**前提条件**

当您需要使用现有资源创建资源栈时，请提前完成如下事项：

1.  获取EIP资源的标识符属性。

    本示例中，获取到的EIP资源的标识符属性为AllocationId，即EIP的实例ID。具体操作，请参见[获取待导入资源的标识符属性](/intl.zh-CN/资源导入/获取待导入资源的标识符属性.md)。

2.  获取EIP的实例ID。

    登录[EIP控制台](https://vpc.console.aliyun.com/eip)，获取要导入的EIP的实例ID。


**操作步骤**

1.  登录[资源编排控制台](http://ros.console.aliyun.com)。

2.  在左侧导航栏，单击**资源栈**。

3.  在页面左上角的地域下拉列表，选择资源栈的所在地域。

    **说明：** 请确保待导入资源与资源栈处于同一地域。

4.  在资源栈列表页面，单击**创建资源栈**，然后在下拉列表中选择**使用现有资源（资源导入）**。

5.  在选择模板页面的**指定模板**区域，选择**选择已有模板**，设置**模板录入方式**为**输入模板**，并在**模板内容**区域输入如下JSON格式的模板，然后单击**下一步**。

    ```
    {
      "ROSTemplateFormatVersion": "2015-09-01",
      "Resources": {
        "Eip": {
          "Type": "ALIYUN::VPC::EIP",
          "DeletionPolicy": "Retain",
          "Properties": {
            "Bandwidth": 5
          }
        }
      },
      "Outputs": {
        "EipAddress": {
          "Value": {
            "Fn::GetAtt": [
              "Eip",
              "EipAddress"
            ]
          }
        },
        "AllocationId": {
          "Value": {
            "Fn::GetAtt": [
              "Eip",
              "AllocationId"
            ]
          }
        }
      }
    }
    ```

    **说明：** `DeletionPolicy`：取值为`Retain`，表示删除保护策略为保留资源。为防止资源被误删除，请务必设置该项。

6.  在识别资源页面，输入资源标识符值（例如：`eip-bp140qv3j25nsfaqd****`），单击**下一步**。

    ![资源导入](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9999590161/p225585.png)

7.  在配置模板参数页面，配置**资源栈名称**和**更改集名称**，单击**下一步**。

8.  在配置资源栈页面，配置相关参数，单击**下一步**。

    本示例使用默认配置。更多信息，请参见[参数说明](#table_nc2_70d_zr1)。

9.  在检查并确认页面，单击**创建资源栈和导入更改集**。

10. 在**更改集**页签，单击更改集右侧**操作**列的**执行**，执行更改集，开始资源导入。

    ![执行更改集](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/4817657061/p190586.png)


**执行结果**

在**资源栈信息**页签，如果**基本信息**区域的**状态**显示为**导入创建完成**，则资源导入成功。

**后续步骤**

您可以在**资源栈信息**页签，单击**偏差状态**右侧的**检测偏差**，检测导入资源的模板与实际模板的匹配情况。具体操作，请参见[检测资源栈的偏差状态](/intl.zh-CN/偏差检测/检测资源栈的偏差状态.md)。

